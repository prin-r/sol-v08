import pytest
from brownie import accounts, Bridge, BridgeData, MockBridge

# Returns the POA mainnet validator set
@pytest.fixture(scope="module")
def poa_validator_set():
    return [
        ["0x652D89a66Eb4eA55366c45b1f9ACfc8e2179E1c5", "1000001"],
        ["0x88e1cd00710495EEB93D4f522d16bC8B87Cb00FE", "1000001"],
        ["0xaAA22E077492CbaD414098EBD98AA8dc1C7AE8D9", "1000001"],
        ["0xB956589b6fC5523eeD0d9eEcfF06262Ce84ff260", "1000001"],
    ]


# Returns a basic mock validator set
@pytest.fixture(scope="module")
def simple_validator_set():
    return [
        ["0x652D89a66Eb4eA55366c45b1f9ACfc8e2179E1c5", 100],
        ["0x88e1cd00710495EEB93D4f522d16bC8B87Cb00FE", 100],
        ["0xaAA22E077492CbaD414098EBD98AA8dc1C7AE8D9", 100],
        ["0xB956589b6fC5523eeD0d9eEcfF06262Ce84ff260", 100],
    ]


# Returns a valid proof from the VRF oracle script
@pytest.fixture(scope="module")
def valid_proof():
    return "000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000007E000000000000000000000000000000000000000000000000000000000000007805248463E932D16F7D092E268C0DED87B23D3B0E71856F1C6AE2AA91F6C7133207FD5F5C7C2920C187618542901CDC5717BE8204F24BE856E80902A1BB04737E4F981716562A49DE06E3DCAFBFB6388C294BAA4FA9D45777E25740A92F81CF65EE8E27CBB44BB654F64EEEF4667868AD48667CEB28E3DB5C4DF7A4B4B87F0C04BFC96CFFD30E5B8979EA66F9D0DA1CBAB16F69669E8B2A1FB2E1BEB457C9726E8C9C8849ED125CC7681329C4D27B83B1FC8ACF7A865C9D1D1DF575CCA56F48DBE3F02642D9E70D5C1C493A4F732BFE9C9B95A4A42651703B816EDCFC8FADA531200000000000000000000000000000000000000000000000000000000000061A8000000000000000000000000000000000000000000000000000000006125894B000000000000000000000000000000000000000000000000000000001152F9089B4825C99C3E739E1DC171FFB0E2BF34E99EEE41B34E407E40CF594834427B09BF23413F237906B07202B3355E7311651ACE6BD2A34FD6FC3BD98EFE4FB787559FB9C7533CAF1D218DA3AF6D277F6B101C42E3C3B75D784242DA663604DD53C27D11A74E40884411901BD7A70631734990B1FDBF5DE9E4C92C63B7650A6A665900000000000000000000000000000000000000000000000000000000000001E00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000044084B8585B71240FEE0E674952B79ED25D793F1B31B42DD37B80F75B98510B57541EC44DD7C5389474DF8E5C25CC6ED8B573CCA2E009AA824EE825BDC693935927000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106D080211A86100000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E1224080112206BF91EFBA26A4CD86EBBD0E54DCFC9BD2C790859CFA96215661A47E4921A63012A0B08CD9296890610EAE9963D320962616E64636861696E0000394365193F819CF539381366D31B6C5849AAA31AE8BA6F95C62C5C80656BFB5C6A07E4A3C0ABCEAE5F854D492DF699438FB84762F152F739DDEAC48DDCFCB5CC000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106D080211A86100000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E1224080112206BF91EFBA26A4CD86EBBD0E54DCFC9BD2C790859CFA96215661A47E4921A63012A0B08CD9296890610EA928633320962616E64636861696E00005D7B4BE7B21B00D08AD7DBE48CF2761CECCB599E64AAB10B2901A0DD58F003257160EF689A533C1E983707507FC8466DAEA1D0DC7A889E3A27D1BB1D09CEC030000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106D080211A86100000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E1224080112206BF91EFBA26A4CD86EBBD0E54DCFC9BD2C790859CFA96215661A47E4921A63012A0B08CD929689061086FAB239320962616E64636861696E00005654A44FB89330C34CF2D862F940763194A145B72ED3BB0ADD5759E1E68FD1452AC795D02A9C574CF12343FDFC67FDCED8A24F88EC8138C7F8230F6EB442B726000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106D080211A86100000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E1224080112206BF91EFBA26A4CD86EBBD0E54DCFC9BD2C790859CFA96215661A47E4921A63012A0B08CD9296890610F0E1F733320962616E64636861696E0000000000000000000000000000000000000000000000000000000000000000052000000000000000000000000000000000000000000000000000000000000061A8000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000D900000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000006124D493000000000000000000000000000000000000000000000000000000006124D497000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000001C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013000000010000000342544300000000000186A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C000000010000000124EC078C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000D9EB739BB22F48B7F3053A90BA2BA4FE07FAB262CADF8664489565C50FF505B8BD00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000D91847107507D5E7B4CD9941EB6FFE1694264AF34C685C19DC478BEADDA265A57800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000D9E80AAE581EC004239854C4D90D8148E85F1F90D0704A73668FD2DA44DC0CEA5300000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000061A7741B794624DBE94D67CD69EEA8D57AAA768D2EA72F1FCA561A4BEFB67836E9E1"

# Returns a vlid proof from the VRF oracle script
@pytest.fixture(scope="module")
def valid_count_proof():
    return "000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000007E000000000000000000000000000000000000000000000000000000000000007805248463E932D16F7D092E268C0DED87B23D3B0E71856F1C6AE2AA91F6C7133207FD5F5C7C2920C187618542901CDC5717BE8204F24BE856E80902A1BB04737E4F981716562A49DE06E3DCAFBFB6388C294BAA4FA9D45777E25740A92F81CF65EE8E27CBB44BB654F64EEEF4667868AD48667CEB28E3DB5C4DF7A4B4B87F0C04BFC96CFFD30E5B8979EA66F9D0DA1CBAB16F69669E8B2A1FB2E1BEB457C9726E8C9C8849ED125CC7681329C4D27B83B1FC8ACF7A865C9D1D1DF575CCA56F48DBE3F02642D9E70D5C1C493A4F732BFE9C9B95A4A42651703B816EDCFC8FADA531200000000000000000000000000000000000000000000000000000000000061A8000000000000000000000000000000000000000000000000000000006125894B000000000000000000000000000000000000000000000000000000001152F9089B4825C99C3E739E1DC171FFB0E2BF34E99EEE41B34E407E40CF594834427B09BF23413F237906B07202B3355E7311651ACE6BD2A34FD6FC3BD98EFE4FB787559FB9C7533CAF1D218DA3AF6D277F6B101C42E3C3B75D784242DA663604DD53C27D11A74E40884411901BD7A70631734990B1FDBF5DE9E4C92C63B7650A6A665900000000000000000000000000000000000000000000000000000000000001E00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000044084B8585B71240FEE0E674952B79ED25D793F1B31B42DD37B80F75B98510B57541EC44DD7C5389474DF8E5C25CC6ED8B573CCA2E009AA824EE825BDC693935927000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106D080211A86100000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E1224080112206BF91EFBA26A4CD86EBBD0E54DCFC9BD2C790859CFA96215661A47E4921A63012A0B08CD9296890610EAE9963D320962616E64636861696E0000394365193F819CF539381366D31B6C5849AAA31AE8BA6F95C62C5C80656BFB5C6A07E4A3C0ABCEAE5F854D492DF699438FB84762F152F739DDEAC48DDCFCB5CC000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106D080211A86100000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E1224080112206BF91EFBA26A4CD86EBBD0E54DCFC9BD2C790859CFA96215661A47E4921A63012A0B08CD9296890610EA928633320962616E64636861696E00005D7B4BE7B21B00D08AD7DBE48CF2761CECCB599E64AAB10B2901A0DD58F003257160EF689A533C1E983707507FC8466DAEA1D0DC7A889E3A27D1BB1D09CEC030000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106D080211A86100000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E1224080112206BF91EFBA26A4CD86EBBD0E54DCFC9BD2C790859CFA96215661A47E4921A63012A0B08CD929689061086FAB239320962616E64636861696E00005654A44FB89330C34CF2D862F940763194A145B72ED3BB0ADD5759E1E68FD1452AC795D02A9C574CF12343FDFC67FDCED8A24F88EC8138C7F8230F6EB442B726000000000000000000000000000000000000000000000000000000000000001C00000000000000000000000000000000000000000000000000000000000000A000000000000000000000000000000000000000000000000000000000000000E000000000000000000000000000000000000000000000000000000000000000106D080211A86100000000000022480A2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003E1224080112206BF91EFBA26A4CD86EBBD0E54DCFC9BD2C790859CFA96215661A47E4921A63012A0B08CD9296890610F0E1F733320962616E64636861696E0000000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000061A8000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000D70000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000061A7BA9949A501EDA86F0F95A96E73E2D74C89F34F42C4A7B6E72E2F0E624E43D96200000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000061A724427D84B35482BBDD44DAF9C13A2C573C8B9DD8FBD4E1BC3B0F9201D707EC6B00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000A00000000000000000000000000000000000000000000000000000000000061A79A6D44D28CF296A1187D95BCDFD8B04E16F639F1D9593BDD8040990D4BE1582600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000061A7CE859DBB78E1B401CF0C91864E6A94E20A647B180804D36982FA2297796F0908"

# Deploy Bridge contract with POA mainnet validator set
@pytest.fixture(scope="module")
def bridge(poa_validator_set):
    return accounts[0].deploy(Bridge, poa_validator_set)


# Deploy Bridge contract with simple validator set
@pytest.fixture(scope="function")
def simplebridge(simple_validator_set):
    return accounts[0].deploy(Bridge, simple_validator_set)


# Deploy MockBridge contract with simple validator set
@pytest.fixture(scope="module")
def mockbridge(simple_validator_set):
    return accounts[0].deploy(MockBridge, simple_validator_set)


# Deploy BridgeData contract
@pytest.fixture(scope="module")
def bridgeinfo(bridge):
    return accounts[0].deploy(BridgeData, bridge.address)


@pytest.fixture(scope="module")
def bridgeinfo_relayed(bridgeinfo, valid_proof):
    bridgeinfo.relayAndSave(valid_proof, {"from": accounts[0]})
    return bridgeinfo
